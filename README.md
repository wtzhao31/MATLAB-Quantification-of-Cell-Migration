# Rapid quantification analysis for cell migration from time series images
This research project uses custom MATLAB scripting paired with ImageJ plugins to quantify migration characteristics of cell migration.

Introduction
Hematopoietic stem cell (HSC) homing and engraftment is a multistep process which involves complex interactions with bone marrow cells. The coordinated action of adhesive molecules and activation processes triggered specifically by chemokines such as SDF-1 and vascular ligands, e.g., vascular cellular adhesion molecule–1 (VCAM-1) has been implicated in HSC migration. Directional migration requires a polarized cell morphology, which has been observed when HSCs were cocultured with mesenchymal stromal cells in vitro. However, the exact molecular regulators of HSC polarization and its roles in HSC motility has yet to be investigated. Previously, we have identified a combination of membrane-bound factors that synergistically induced HSC polarization, namely SCF and VCAM-1. Implementing a chemoattractant gradient to encourage HSC migration will allow us to examine the relationship between HSC polarization and migration. 

To examine the roles of the induced morphology in HSC chemotaxis, it is first necessary to quantify the migration characteristics of an HSC population. Currently, many researchers utilize two ImageJ plugins––Manual Tracking and Chemotaxis Tool––to track cell movements and analyze migration characteristics, respectively. However, this method is insufficient for our research purposes. In this project, we developed a method that improves upon existing cell tracking and chemotaxis analysis approaches by pairing automated cell tracking with custom MATLAB scripting for more flexible data analysis and visualization of cell migration. Moreover, we show the potential of our novel quantification method by using it to demonstrate the effect of different membrane-bound factors (SCF and VCAM-1) on HSC migration.

Materials and Methods
Experimental setup: HSCs (Lin-cKit+Sca1+Flk2-CD34-Slamf1+) were enriched, immunostained, and FACS-sorted from bones of C57BL/6Ka mice. Synthetic lipids with biotin- and NTA(Ni)- functional headgroups were mixed with DOPC, extruded and deposited on a clean glass surface to self-assemble into a single fluid supported lipid bilayer (SLB) (Fig.1A). Mono-biotinylated SCF and poly-His-tagged VCAM-1 were tethered to the SLB to mimic the stromal cell membrane. HSCs were seeded onto SLB to interact with the membrane-bound factors and were live-imaged for 1 hour to produce time-series images to assess cell mobility (Fig.1B).

Cell tracking and data analysis: Time-series images were imported into ImageJ, where cell movements were automatically tracked using the TrackMate plugin (Fig.1C). Tracking data containing each cell’s x and y coordinates throughout the time-lapse was then exported from TrackMate (Fig.1D) and loaded into MATLAB. Computational algorithms were applied to every cell at every time-step to calculate migration characteristics (Fig.1E). Analyzed data was exported as an Excel spreadsheet  (Fig.1F) and plotted using Prism. Origin and rose plots could also be generated from MATLAB to visualize cell movements (Fig.1G).

Results and Conclusion
TrackMate-MATLAB quantification method provides more flexibility for cell migration analysis. Currently, ImageJ Manual Tracking and Chemotaxis Tool plugins are used to quantify cell migration. Using Manual Tracking, the x and y coordinates of selected cells are tracked throughout the time-series image. This recorded data is then imported into Chemotaxis Tool, which analyzes these coordinate data points to quantify the cells’ migration characteristics (Fig.2A). However, the Manual Tracking component is tedious for tracking a large number of cells and is prone to human error. Additionally, the analyzed data from Chemotaxis Tool provides no information regarding the change in a cell’s migration characteristics over time.

Our novel quantification method improves upon this existing process by utilizing ImageJ TrackMate automated cell tracking and MATLAB scripting to customize data analysis. Similar to Manual Tracking, TrackMate records each cells’ x/y coordinates as they change over time, but does not require cells to be tracked manually. This increases the speed of quantification and provides more data points for statistical analysis (Fig.2A). MATLAB scripts were programmed to read TrackMate data and compute cells’ migration characteristics at every time step, a component Chemotaxis Tool lacked. Moreover, unlike Chemotaxis Tool, our MATLAB code allows this data to be exported as an Excel spreadsheet for further data analysis and plot generation using tools such as Prism. Comparing plots generated from our MATLAB code with plots from Chemotaxis Tool signifies the accuracy our method possesses while attaining a greater number of datapoints from automated cell tracking (Fig.2B,C). 

HSCs showed high motility on membrane-bound SCF-VCAM-1. To validate our quantification method, we characterized HSC migration on membrane-bound factors. HSCs seeded onto SLB containing SCF and VCAM-1 possessed the highest accumulated distance and motility (Fig.3A,B). The automated tracking component of our TrackMate-MATLAB method allowed us to interpret the migration characteristics of 150-200 HSCs, giving a more representative understanding of their movement patterns as a whole. Moreover, our MATLAB scripts provided the computational power to calculate a multitude of migration characteristics for HSCs at every time-slice. Without this quantification method, current chemotaxis data analysis methods would have been used, which do not provide the same functionality and flexibility as our method.
Conclusion. In this project, we demonstrate a viable quantification method that supersedes current cell chemotaxis quantification approaches. Not only does the TrackMate-MATLAB method increase our sample size by eliminating the tedious and time-consuming manual tracking of cells, it also computes important migration characteristics for all cells at every time-step. This summer, we plan to use this quantification method to establish connections between HSC migration characteristics and changes in cell morphology in the presence of a CXCL12 chemoattractant. 

<img width="627" alt="Screen Shot 2021-05-26 at 8 48 24 PM" src="https://user-images.githubusercontent.com/84831514/119763092-ba34e300-be63-11eb-9560-8d93e437ebda.png">
Figure 1. Established workflow for HSC migration quantification using TrackMate-MATLAB method. A) HSCs seeded onto SLB containing membrane-bound factors SCF, VCAM-1, or both. B) Time-series images generated with live cell imaging. C) Cells’ movements tracked using ImageJ TrackMate. D) Cells’ x/y coordinates exported as Excel sheet. E) TrackMate data imported into MATLAB, computations performed to calculate speed, euclidean distance, accumulated distance, directionality, x/y FMI, and vector displacement at each slice for every cell. F) Analyzed migration data exported as Excel sheet. G) Cell movements visualized through origin plot.

<img width="670" alt="Screen Shot 2021-05-26 at 8 48 59 PM" src="https://user-images.githubusercontent.com/84831514/119763136-cd47b300-be63-11eb-90c6-9ab27d837636.png">

Figure 2. Comparison between currently utilized Manual Tracking-Chemotaxis Tool and new TrackMate-MATLAB method. A) Summary of comparison. B) Sample origin plot from Manual Tracking-Chemotaxis Tool (30 cells). C) Origin plot from same data generated with TrackMate-MATLAB method (150 cells).

<img width="666" alt="Screen Shot 2021-05-26 at 8 49 10 PM" src="https://user-images.githubusercontent.com/84831514/119763152-d46ec100-be63-11eb-8ae1-56a868706c4d.png">
Figure 3. HSCs seeded on SCF and VCAM-1-containing surfaces without chemoattractant gradient demonstrated higher motility and total distance traveled. A) Origin plots generated from MATLAB for a sample of 20 HSCs seeded on surfaces containing either VCAM1, mSCF, or both molecules. B) Accumulated distances for 50 cells in each condition, plotted with Prism using analyzed data from our MATLAB code. 
